<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StratOS | Rahul J</title>
    <!-- Custom Favicon: Electric Cyan Microchip -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2064%2064%22%3E%3Crect%20x%3D%2216%22%20y%3D%2216%22%20width%3D%2232%22%20height%3D%2232%22%20rx%3D%224%22%20fill%3D%22%230d1117%22%20stroke%3D%22%2300f3ff%22%20stroke-width%3D%224%22%2F%3E%3Cpath%20d%3D%22M32%2016V8%20M32%2048V56%20M16%2032H8%20M48%2032H56%20M24%2016V8%20M40%2016V8%20M24%2048V56%20M40%2048V56%20M16%2024H8%20M48%2024H56%20M16%2040H8%20M48%2040H56%22%20stroke%3D%22%2300f3ff%22%20stroke-width%3D%224%22%20stroke-linecap%3D%22round%22%2F%3E%3C%2Fsvg%3E">
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #0d1117;
            --window-bg: rgba(13, 17, 23, 0.85); /* Slightly more transparent for aesthetic bg */
            --taskbar-bg: rgba(13, 17, 23, 0.75);
            --text-color: #e6edf3;
            --accent-color: #00f3ff;
            --accent-green: #0aff60;
            --accent-red: #ff2a6d;
            --glass-border: 1px solid rgba(255, 255, 255, 0.1);
            --discord-bg: #111214;
            --discord-card: #232428;
            --discord-blurple: #5865F2;
            --vscode-bg: #1e1e1e;
            --vscode-sidebar: #252526;
            --vscode-activity: #333333;
            --chat-bg: #0f111a;
            --chat-bubble-user: #008891;
            --chat-bubble-bot: #21262d;
        }

        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: 'Inter', sans-serif;
            /* Aesthetic Abstract Background */
            background: url('https://images.unsplash.com/photo-1620121692029-d088224ddc74?q=80&w=1632&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D') no-repeat center center fixed;
            background-size: cover;
            color: var(--text-color);
            height: 100vh;
            user-select: none;
        }

        /* Subtle Vignette Overlay */
        body::after {
            content: "";
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, rgba(0,0,0,0) 50%, rgba(0,0,0,0.4) 100%);
            pointer-events: none;
            z-index: 0;
        }

        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #424242; border-radius: 5px; border: 1px solid rgba(255,255,255,0.1); }
        ::-webkit-scrollbar-thumb:hover { background: var(--accent-color); }

        #boot-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; color: var(--accent-color); font-family: 'JetBrains Mono', monospace;
            z-index: 9999; display: flex; flex-direction: column;
            justify-content: center; align-items: center; font-size: 14px;
        }
        #boot-logo { font-size: 64px; margin-bottom: 30px; text-shadow: 0 0 20px var(--accent-color); animation: flicker 2s infinite; }
        #boot-log { width: 320px; text-align: left; font-size: 13px; display: flex; flex-direction: column; gap: 4px; }
        .log-line { opacity: 0; animation: fadeIn 0.1s forwards; white-space: nowrap; overflow: hidden; }
        
        @keyframes fadeIn { to { opacity: 1; } }
        @keyframes flicker { 0% { opacity: 0.8; } 50% { opacity: 1; } 100% { opacity: 0.8; } }

        #image-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 20000;
            justify-content: center; align-items: center; backdrop-filter: blur(10px);
        }
        #modal-img { max-width: 90%; max-height: 90%; border-radius: 4px; box-shadow: 0 0 40px rgba(0,243,255,0.3); border: 1px solid var(--accent-color); }
        #modal-close { position: absolute; top: 20px; right: 30px; font-size: 40px; color: white; cursor: pointer; z-index: 20001; }

        #notification-area {
            position: absolute; top: 20px; right: 20px; z-index: 10000;
            display: flex; flex-direction: column; gap: 10px; pointer-events: none;
        }
        .toast {
            pointer-events: auto; background: rgba(13, 17, 23, 0.95);
            border: 1px solid rgba(0, 243, 255, 0.2); border-left: 4px solid var(--accent-color);
            padding: 15px; border-radius: 6px; color: #fff; width: 320px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5); animation: slideInRight 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            display: flex; flex-direction: column; gap: 6px; backdrop-filter: blur(12px);
        }
        .toast-title { font-weight: bold; font-size: 14px; color: var(--accent-color); display: flex; justify-content: space-between; align-items: center;}
        .toast-msg { font-size: 13px; color: #c9d1d9; line-height: 1.5; }
        @keyframes slideInRight { from { transform: translateX(120%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        @keyframes fadeOut { from { opacity: 1; transform: translateX(0); } to { opacity: 0; transform: translateX(20px); } }

        #desktop {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            padding: 30px; display: flex; flex-direction: column; flex-wrap: wrap;
            gap: 20px; align-content: flex-start; z-index: 1;
        }
        .desktop-icon {
            width: 90px; height: 105px; display: flex; flex-direction: column;
            align-items: center; justify-content: center; cursor: pointer;
            border-radius: 8px; transition: all 0.2s; color: rgba(255,255,255,0.9);
            text-shadow: 0 2px 4px rgba(0,0,0,0.9);
        }
        .desktop-icon:hover { background: rgba(0, 243, 255, 0.1); backdrop-filter: blur(10px); transform: translateY(-3px); color: #fff; text-shadow: 0 0 10px var(--accent-color); }
        .desktop-icon i { font-size: 42px; margin-bottom: 10px; filter: drop-shadow(0 4px 8px rgba(0,0,0,0.7)); }
        .desktop-icon span { font-size: 13px; text-align: center; font-weight: 500; line-height: 1.2; }

        .window {
            position: absolute; background: var(--window-bg); backdrop-filter: blur(25px);
            border: var(--glass-border); border-radius: 12px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8); display: flex; flex-direction: column;
            overflow: hidden; min-width: 200px; min-height: 100px;
            transition: opacity 0.2s, transform 0.2s; animation: openWin 0.3s cubic-bezier(0.16, 1, 0.3, 1); z-index: 10;
        }
        @keyframes openWin { from { opacity: 0; transform: scale(0.95) translateY(10px); } to { opacity: 1; transform: scale(1) translateY(0); } }
        .window.minimized { opacity: 0; transform: scale(0.8) translateY(200px); pointer-events: none; }
        .window.maximized { top: 0 !important; left: 0 !important; width: 100% !important; height: calc(100% - 60px) !important; border-radius: 0; }
        .window-header {
            background: linear-gradient(to right, rgba(255,255,255,0.05), rgba(255,255,255,0.02));
            padding: 12px 16px; display: flex; justify-content: space-between; align-items: center;
            cursor: default; border-bottom: 1px solid rgba(255, 255, 255, 0.08); user-select: none;
        }
        .window-title { font-size: 13px; font-weight: 600; display: flex; align-items: center; gap: 10px; color: rgba(255,255,255,0.95); }
        .window-controls { display: flex; gap: 8px; }
        .control-btn { width: 12px; height: 12px; border-radius: 50%; cursor: pointer; position: relative; }
        .close-btn { background: #ff5f56; }
        .min-btn { background: #ffbd2e; }
        .max-btn { background: #27c93f; }
        .window-content { flex-grow: 1; overflow: hidden; position: relative; display: flex; flex-direction: column; }

        .terminal-app { background-color: #050505; color: #ccc; font-family: 'JetBrains Mono', monospace; height: 100%; padding: 8px; box-sizing: border-box; font-size: 14px; display: flex; flex-direction: column; }
        .terminal-scroll { flex-grow: 1; overflow-y: auto; padding: 10px; }
        .term-line { margin-bottom: 3px; line-height: 1.5; }
        .term-input-line { display: flex; margin-top: 5px; align-items: center; }
        .prompt-user { color: var(--accent-green); font-weight: bold; }
        .term-input { background: transparent; border: none; color: #fff; font-family: inherit; font-size: inherit; flex-grow: 1; outline: none; }

        .chat-app { display: flex; flex-direction: column; height: 100%; background: var(--chat-bg); }
        .chat-messages { flex-grow: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; }
        .chat-input-area { padding: 15px; background: rgba(0,0,0,0.2); border-top: 1px solid rgba(255,255,255,0.1); display: flex; gap: 10px; }
        .chat-input { flex-grow: 1; background: #21262d; border: 1px solid #30363d; color: white; padding: 10px; border-radius: 6px; outline: none; }
        .chat-btn { background: var(--accent-color); color: #000; border: none; padding: 0 20px; border-radius: 6px; cursor: pointer; font-weight: bold; }
        .chat-bubble { max-width: 80%; padding: 10px 15px; border-radius: 12px; font-size: 14px; word-wrap: break-word; }
        .chat-bubble.user { align-self: flex-end; background: var(--chat-bubble-user); color: white; }
        .chat-bubble.bot { align-self: flex-start; background: var(--chat-bubble-bot); color: #e6edf3; border: 1px solid #30363d; }
        
        .browser-app { display: flex; flex-direction: column; height: 100%; background: #1a1a1a; }
        .browser-bar { background: rgba(30, 30, 30, 0.9); padding: 10px 15px; display: flex; gap: 12px; border-bottom: 1px solid #333; align-items: center; }
        .url-bar { flex-grow: 1; background: #0d0d0d; border: 1px solid #333; padding: 8px 16px; border-radius: 8px; font-size: 13px; color: #eee; font-family: 'JetBrains Mono', monospace; }
        .browser-content { flex-grow: 1; background: #fff; position: relative; overflow: hidden; }
        /* Browser Home Styles */
        .browser-home { 
            width: 100%; height: 100%; 
            background: #0d1117; 
            background-image: radial-gradient(#21262d 1px, transparent 1px); 
            background-size: 20px 20px; 
            display: flex; flex-direction: column; align-items: center; justify-content: center; 
            gap: 40px; 
            overflow-y: auto;
            box-sizing: border-box;
            padding: 20px;
        }
        .dial-grid { display: flex; gap: 30px; flex-wrap: wrap; justify-content: center; max-width: 800px; padding: 20px; }
        .dial-item { width: 130px; height: 130px; background: rgba(33, 38, 45, 0.8); border-radius: 16px; display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; transition: all 0.2s; border: 1px solid #30363d; backdrop-filter: blur(5px); }
        .dial-item:hover { transform: translateY(-8px); background: #30363d; border-color: var(--accent-color); box-shadow: 0 0 20px rgba(0, 243, 255, 0.2); }
        .dial-icon { font-size: 48px; margin-bottom: 15px; color: #e6edf3; }
        .dial-label { font-weight: 600; font-size: 14px; color: #e6edf3; }

        /* Tools Hub Styles */
        .tools-hub-container { 
            width: 100%; height: 100%; 
            display: flex; flex-direction: column; align-items: center; 
            justify-content: flex-start; 
            background: #0d1117; 
            gap: 40px; 
            overflow-y: auto; 
            padding: 40px 20px; 
            box-sizing: border-box; 
        }
        .tools-header { font-size: 28px; font-weight: bold; color: #fff; text-align: center; text-transform: uppercase; letter-spacing: 2px; }
        .tool-cards { display: flex; gap: 30px; justify-content: center; flex-wrap: wrap; margin-bottom: 40px; }
        .tool-card { width: 220px; height: 160px; background: #161b22; border: 1px solid #30363d; border-radius: 12px; display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s ease; position: relative; overflow: hidden; flex-shrink: 0; }
        .tool-card:hover { border-color: var(--accent-color); transform: translateY(-5px); box-shadow: 0 0 30px rgba(0, 243, 255, 0.2); }
        .tool-card:hover .tool-bg { opacity: 0.1; transform: scale(1.2); }
        .tool-bg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(45deg, var(--accent-color), #a371f7); opacity: 0; transition: all 0.5s; z-index: 0; }
        .tool-icon { font-size: 40px; margin-bottom: 15px; color: #e6edf3; z-index: 1; }
        .tool-name { font-size: 16px; font-weight: bold; color: #fff; z-index: 1; }
        .tool-desc { font-size: 12px; color: #8b949e; margin-top: 5px; z-index: 1; text-align: center; }

        /* Social / GitHub */
        .social-feed { width: 100%; height: 100%; overflow-y: auto; background: #0d1117; padding: 20px; box-sizing: border-box; }
        .github-layout { display: flex; gap: 20px; height: 100%; }
        .github-sidebar { width: 260px; flex-shrink: 0; }
        .github-main { flex-grow: 1; overflow-y: auto; }
        .profile-img { width: 250px; height: 250px; border-radius: 50%; object-fit: cover; border: 1px solid #30363d; margin-bottom: 15px; }
        .profile-name { font-size: 24px; font-weight: bold; color: #c9d1d9; }
        .profile-login { font-size: 20px; color: #8b949e; font-weight: 300; margin-bottom: 15px; }
        .repo-grid { display: flex; flex-direction: column; gap: 10px; padding-bottom: 20px; }
        .card { background: #0d1117; border: 1px solid #30363d; border-radius: 6px; padding: 15px; display: flex; justify-content: space-between; align-items: center; transition: all 0.2s; }
        .card:hover { border-color: var(--accent-color); background: #161b22; }
        .card-left { flex-grow: 1; min-width: 0; margin-right: 15px; }
        .card-title { font-weight: bold; color: var(--accent-color); font-size: 16px; margin-bottom: 4px; display: flex; align-items: center; gap: 8px;}
        .card-desc { font-size: 13px; color: #8b949e; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; }
        .card-meta { font-size: 12px; color: #8b949e; margin-top: 6px; display: flex; gap: 15px; align-items: center;}
        .lang-dot { width: 10px; height: 10px; border-radius: 50%; display: inline-block; margin-right: 5px; }
        .card-actions { display: flex; gap: 10px; }
        .repo-btn { padding: 6px 12px; border: 1px solid #30363d; background: #21262d; color: #c9d1d9; border-radius: 6px; font-size: 12px; cursor: pointer; text-decoration: none; display: flex; align-items: center; gap: 5px; transition: background 0.2s; }
        .repo-btn:hover { background: #30363d; color: #fff; }

        /* Discord */
        .discord-container { width: 100%; height: 100%; background: var(--discord-bg); display: flex; justify-content: center; align-items: center; overflow-y: auto; }
        .discord-modal { width: 600px; background: var(--discord-card); border-radius: 12px; overflow: hidden; box-shadow: 0 10px 40px rgba(0,0,0,0.6); position: relative; margin: 20px; }
        .discord-banner { height: 210px; background-color: var(--discord-blurple); background-size: cover; background-position: center; }
        .discord-avatar-wrapper { position: absolute; top: 156px; left: 20px; width: 128px; height: 128px; border-radius: 50%; background: var(--discord-card); padding: 7px; }
        .discord-avatar { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; position: relative; z-index: 1; }
        .discord-status-dot { width: 28px; height: 28px; border-radius: 50%; border: 5px solid var(--discord-card); position: absolute; bottom: 5px; right: 5px; z-index: 3; }
        .discord-body { margin-top: 80px; padding: 20px; background: #2b2d31; border-radius: 12px; margin: 16px; margin-top: 70px; }
        .discord-username { font-size: 22px; font-weight: 700; color: #fff; }
        .discord-handle { font-size: 14px; color: #b9bbbe; margin-bottom: 20px; }
        .discord-section-title { font-size: 11px; font-weight: 800; color: #b9bbbe; text-transform: uppercase; margin-bottom: 8px; letter-spacing: 0.5px; }
        .discord-bio { font-size: 14px; color: #dbdee1; white-space: pre-wrap; line-height: 1.4; margin-bottom: 20px; }
        .discord-activity-card { background: #111214; border-radius: 8px; padding: 12px; display: flex; gap: 12px; align-items: center; margin-top: 10px; }

        .vscode-layout { display: flex; height: 100%; background: var(--vscode-bg); color: #ccc; }
        .vscode-activity-bar { width: 48px; background: var(--vscode-activity); display: flex; flex-direction: column; align-items: center; padding-top: 10px; }
        .vscode-icon { font-size: 24px; color: #858585; margin-bottom: 25px; cursor: pointer; }
        .vscode-sidebar { width: 200px; background: var(--vscode-sidebar); font-size: 13px; border-right: 1px solid #1e1e1e; }
        .vscode-file { padding: 4px 20px; cursor: pointer; display: flex; align-items: center; gap: 6px; border-left: 2px solid transparent; }
        .vscode-file.active { background: #37373d; color: #fff; border-left: 2px solid var(--accent-color); }
        .vscode-main { flex-grow: 1; display: flex; flex-direction: column; }
        .vscode-tabs { display: flex; background: var(--vscode-sidebar); }
        .vscode-tab { padding: 8px 15px; background: var(--vscode-sidebar); color: #969696; font-size: 13px; border-right: 1px solid #1e1e1e; }
        .vscode-tab.active { background: var(--vscode-bg); color: #fff; border-top: 1px solid var(--accent-color); }
        .vscode-editor-area { flex-grow: 1; display: flex; }
        .vscode-gutter { width: 50px; text-align: right; padding-right: 15px; padding-top: 10px; font-family: 'Consolas', monospace; font-size: 14px; color: #858585; border-right: 1px solid rgba(255,255,255,0.05); }
        .vscode-code { flex-grow: 1; padding: 10px; font-family: 'Consolas', monospace; font-size: 14px; white-space: pre; overflow: auto; outline: none; }
        .vscode-status-bar { height: 22px; background: var(--accent-color); color: #000; display: flex; align-items: center; padding: 0 10px; font-size: 12px; font-weight: bold; }

        #taskbar { position: absolute; bottom: 15px; left: 50%; transform: translateX(-50%); width: 90%; height: 52px; background: var(--taskbar-bg); backdrop-filter: blur(20px); border: var(--glass-border); border-radius: 14px; display: flex; align-items: center; padding: 0 10px; z-index: 1000; }
        /* Updated Start Button Style */
        #start-btn { 
            width: 40px; 
            height: 40px; 
            border-radius: 12px; 
            background: linear-gradient(135deg, #00f3ff, #008891); /* Cyan/Teal Gradient */
            color: #000; /* Dark icon for contrast */
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 22px; 
            cursor: pointer; 
            margin-right: 15px;
            box-shadow: 0 0 10px rgba(0, 243, 255, 0.4);
        }
        .task-list { display: flex; gap: 8px; flex-grow: 1; }
        .task-item { width: 42px; height: 42px; border-radius: 10px; display: flex; align-items: center; justify-content: center; cursor: pointer; background: rgba(255,255,255,0.05); transition: 0.2s; position: relative; }
        .task-item.active::after { content: ''; position: absolute; bottom: -4px; width: 16px; height: 3px; background: var(--accent-color); border-radius: 2px; }

        #start-menu { position: absolute; bottom: 80px; left: 5%; width: 320px; background: rgba(22, 27, 34, 0.95); border: var(--glass-border); border-radius: 12px; padding: 15px; display: none; flex-direction: column; gap: 10px; z-index: 1001; }
        .start-item { padding: 10px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; gap: 12px; transition: 0.1s; }
        .start-item:hover { background: rgba(255,255,255,0.1); }

        .chess-card { background: #161b22; padding: 20px; border-radius: 12px; border: 1px solid #30363d; display: flex; flex-direction: column; gap: 15px; align-items: center; width: 300px; }
        .chess-avatar { width: 70px; height: 70px; border-radius: 8px; border: 2px solid #2ea043; }
        .chess-stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; width: 100%; }
        .stat-box { background: rgba(255,255,255,0.05); padding: 8px; border-radius: 6px; text-align: center; }

        .token-keyword { color: #569cd6; }
        .token-string { color: #ce9178; }

        /* Network Status in Tray */
        .tray-item { display: flex; align-items: center; gap: 6px; opacity: 0.8; font-size: 12px; color: white; transition: opacity 0.2s; }
        .tray-item:hover { opacity: 1; }
        .tray-icon { color: var(--accent-green); }
    </style>
</head>
<body>

    <div id="image-modal">
        <div id="modal-close" onclick="document.getElementById('image-modal').style.display='none'">&times;</div>
        <img id="modal-img" src="">
    </div>

    <div id="notification-area"></div>

    <div id="boot-screen">
        <div id="boot-logo"><i class="fa-solid fa-fingerprint"></i></div>
        <div id="boot-log"></div>
    </div>

    <div id="start-menu">
        <div style="font-weight:bold; border-bottom:1px solid rgba(255,255,255,0.1); padding-bottom:10px;">Rahul J | Architect</div>
        <div class="start-item" onclick="createWindow('Terminal', 'terminal')"><i class="fa-solid fa-terminal"></i> Terminal</div>
        <div class="start-item" onclick="createWindow('CustomLLM', 'neuralchat')"><i class="fa-solid fa-microchip"></i> CustomLLM</div>
        <div class="start-item" onclick="createWindow('Browser', 'browser')"><i class="fa-solid fa-globe"></i> Browser</div>
        <div class="start-item" onclick="location.reload()" style="color:#ff7b72"><i class="fa-solid fa-power-off"></i> Shut Down</div>
    </div>

    <div id="desktop"></div>

    <div id="taskbar">
        <!-- New Start Button: Fingerprint with Cyan Gradient -->
        <div id="start-btn" onclick="toggleStartMenu()"><i class="fa-solid fa-fingerprint"></i></div>
        <div class="task-list" id="task-list"></div>
        
        <div style="margin-left:auto; display:flex; gap:20px; padding-right:15px; align-items:center;">
            <!-- Removed Curiosity Status -->
            <div id="clock-area" style="text-align:right; color:white; font-size:12px;">
                <div id="clock-time">00:00</div>
                <div id="clock-date">Jan 01</div>
            </div>
        </div>
    </div>

    <script>
        const MISTRAL_KEY = "blAJT7bc5KHXR5UG3MbHl5OoyNF9Z9Jv"; // Reconstructed
        const DISCORD_ID = "1110960444165849128";
        const fileSystem = {
            "forex_algo.py": { content: `import numpy as np\nclass LiquidityHunter:\n    def __init__(self):\n        self.elo = 1826` },
            "bio.md": { content: `# Rahul J\n## Strategic Architect & AI Engineer\n\nI exist at the intersection of algorithmic precision and human intuition. My work focuses on deconstructing market microstructures and architecting neural networks that don't just learn, but *reason*.\n\n### Core Competencies\n- **AI/ML**: Building cognitive engines, not just models.\n- **System Architecture**: Scalable, resilient, and efficient.\n- **Strategy**: Applying game theory to code and markets.\n\n> "Tactics is knowing what to do when there is something to do. Strategy is knowing what to do when there is nothing to do."\n> ‚Äî Savielly Tartakower` },
            "philosophy.txt": { content: `THE UNANSWERED QUESTIONS\n\n1. If a neural network dreams, does it fear the wake-up call?\n2. Is consciousness a feature or a bug in the universal code?\n3. If we simulate a universe perfectly, are we gods or just admins?\n4. Does the strategy exist before the game, or does the game create the strategy?\n5. In the game of life, is the king more important than the pawn, or just more trapped?\n\n"The only true wisdom is in knowing you know nothing."` },
            "MACD_Scalper.mq4": { content: `//+------------------------------------------------------------------+
//|                                              Neural_MACD_Pro_v9.mq4 |
//|                                   Copyright 2024, Rahul J Systems   |
//|                                        https://www.stratos-ai.com   |
//+------------------------------------------------------------------+
#property copyright "Rahul J"
#property link      "https://www.stratos-ai.com"
#property version   "9.42"
#property strict

//--- INPUT PARAMETERS ---
input string   Risk_Settings = "=== RISK MANAGEMENT ===";
input double   RiskPercent    = 2.0;       // Risk per trade (%)
input double   MaxDrawdown    = 15.0;      // Max Daily Drawdown (%)
input double   LotSize        = 0.1;       // Fixed Lot (if Risk=0)
input bool     UseMartingale  = false;     // Enable Recovery Mode
input double   MartingaleMult = 1.5;       // Recovery Multiplier

input string   Indi_Settings = "=== INDICATOR LOGIC ===";
input int      FastEMA        = 12;        // Fast EMA Period
input int      SlowEMA        = 26;        // Slow EMA Period
input int      SignalSMA      = 9;         // Signal Period
input int      RSI_Period     = 14;        // Relative Strength Index
input int      Stoch_K        = 5;         // Stochastic K
input int      Stoch_D        = 3;         // Stochastic D
input int      Stoch_Slow     = 3;         // Stochastic Slowing

//--- GLOBAL VARIABLES ---
int       MagicNumber = 133742;
double    PipValue;
datetime  LastTradeTime;
bool      IsHedging = false;

//+------------------------------------------------------------------+
//| Expert initialization function                                   |
//+------------------------------------------------------------------+
int OnInit()
  {
   if(Digits==3 || Digits==5) PipValue = Point*10;
   else PipValue = Point;
   
   Print("Initialization Complete. Neural Filter: ACTIVE");
   return(INIT_SUCCEEDED);
  }

//+------------------------------------------------------------------+
//| Expert tick function                                             |
//+------------------------------------------------------------------+
void OnTick()
  {
   // --- PRE-TRADE CHECKS ---
   if(IsNewBar() == false) return;
   if(CheckDrawdown() == false) { Print("Drawdown Limit Hit. Halting."); return; }
   
   // --- SIGNAL CALCULATION ---
   double macd_main   = iMACD(NULL,0,FastEMA,SlowEMA,SignalSMA,PRICE_CLOSE,MODE_MAIN,0);
   double macd_signal = iMACD(NULL,0,FastEMA,SlowEMA,SignalSMA,PRICE_CLOSE,MODE_SIGNAL,0);
   double rsi         = iRSI(NULL,0,RSI_Period,PRICE_CLOSE,0);
   double stoch_main  = iStochastic(NULL,0,Stoch_K,Stoch_D,Stoch_Slow,MODE_SMA,0,MODE_MAIN,0);
   
   // --- NEURAL FILTER SIMULATION ---
   bool neural_confirm = NeuralNetFilter(macd_main, rsi, stoch_main);
   
   // --- EXECUTION LOGIC ---
   if(macd_main > macd_signal && rsi < 70 && stoch_main < 80 && neural_confirm)
     {
      if(OrdersTotal() == 0) OpenOrder(OP_BUY);
     }
   else if(macd_main < macd_signal && rsi > 30 && stoch_main > 20 && neural_confirm)
     {
      if(OrdersTotal() == 0) OpenOrder(OP_SELL);
     }
     
   // --- TRAILING STOP LOGIC ---
   ManageTrades();
  }

//+------------------------------------------------------------------+
//| Custom Functions                                                 |
//+------------------------------------------------------------------+
bool NeuralNetFilter(double m, double r, double s)
  {
   // Simulating complex weight calculation from external Python model
   double w1 = 0.432; 
   double w2 = 0.115;
   double w3 = 0.884;
   double bias = 0.05;
   
   double activation = (m*w1) + (r*w2) + (s*w3) + bias;
   
   if(activation > 0.65) return true;
   return false; // Filter out weak signals
  }

void OpenOrder(int type)
  {
   double sl = 0, tp = 0;
   double price = (type == OP_BUY) ? Ask : Bid;
   
   if(type == OP_BUY)
     {
      sl = price - 50 * PipValue;
      tp = price + 100 * PipValue;
     }
   else
     {
      sl = price + 50 * PipValue;
      tp = price - 100 * PipValue;
     }
     
   int ticket = OrderSend(Symbol(), type, CalculateLot(), price, 3, sl, tp, "Neural_Entry", MagicNumber, 0, Blue);
   if(ticket < 0) Print("OrderSend failed with error #",GetLastError());
  }

double CalculateLot()
  {
   double balance = AccountBalance();
   double riskMoney = balance * (RiskPercent / 100);
   // Complex lot calculation based on margin and leverage
   return LotSize; // Fallback
  }

bool CheckDrawdown() { return true; /* Placeholder for complexity */ }
bool IsNewBar() { return true; /* Placeholder */ }
void ManageTrades() { /* Trailing stop logic */ }
` },
            "Breakout_King.mq5": { content: `//+------------------------------------------------------------------+
//|                                             Quantum_Breakout_X.mq5 |
//|                                   Copyright 2024, Rahul J Systems  |
//|                                       AI-Driven Liquidity Hunter   |
//+------------------------------------------------------------------+
#include <Trade\\Trade.mqh>
#include <Trade\\SymbolInfo.mqh>
#include <Trade\\PositionInfo.mqh>

CTrade         m_trade;
CSymbolInfo    m_symbol;
CPositionInfo  m_position;

//--- INPUT PARAMETERS ---
input group    "--- STRATEGY SETTINGS ---"
input int      LookBackPeriod = 24;        // H1 Candles to scan
input double   BreakoutFactor = 1.0005;    // Threshold for entry
input int      VolatilityFilter = 14;      // ATR Period
input bool     UseSmartLiquidity = true;   // Enable Order Flow Analysis

input group    "--- EXECUTION ENGINE ---"
input double   InitialLot     = 0.5;
input int      Magic_ID       = 998877;
input int      Slippage       = 10;

//--- GLOBAL BUFFERS ---
double HighBuffer[];
double LowBuffer[];
double ATRBuffer[];
int    ATRHandle;

//+------------------------------------------------------------------+
//| Expert initialization function                                   |
//+------------------------------------------------------------------+
int OnInit()
  {
   ATRHandle = iATR(_Symbol, _Period, VolatilityFilter);
   if(ATRHandle == INVALID_HANDLE) 
     {
      Print("Failed to load ATR indicator");
      return(INIT_FAILED);
     }
     
   m_trade.SetExpertMagicNumber(Magic_ID);
   Print("Quantum Engine: ONLINE. Scanning for liquidity pools...");
   return(INIT_SUCCEEDED);
  }

//+------------------------------------------------------------------+
//| Expert tick function                                             |
//+------------------------------------------------------------------+
void OnTick()
  {
   if(!m_symbol.Name(_Symbol)) return;
   m_symbol.RefreshRates();
   
   // --- DATA GATHERING ---
   CopyHigh(_Symbol, _Period, 1, LookBackPeriod, HighBuffer);
   CopyLow(_Symbol, _Period, 1, LookBackPeriod, LowBuffer);
   
   double highestHigh = HighBuffer[ArrayMaximum(HighBuffer)];
   double lowestLow   = LowBuffer[ArrayMinimum(LowBuffer)];
   
   // --- ORDER FLOW ANALYSIS (Simulated) ---
   double buyVolume = 0; // In real logic, get from DOM
   double sellVolume = 0;
   
   if(UseSmartLiquidity)
     {
      // Mock liquidity sweep logic
      if(m_symbol.Ask() > highestHigh) 
         Print("Liquidity Pool Breach DETECTED at: ", highestHigh);
     }
     
   // --- ENTRY LOGIC ---
   if(PositionsTotal() == 0)
     {
      if(m_symbol.Ask() > highestHigh * BreakoutFactor)
        {
         double sl = lowestLow;
         double tp = m_symbol.Ask() + (m_symbol.Ask() - lowestLow) * 2; // 1:2 R:R
         m_trade.Buy(InitialLot, _Symbol, m_symbol.Ask(), sl, tp, "Breakout_Long");
        }
      else if(m_symbol.Bid() < lowestLow / BreakoutFactor)
        {
         double sl = highestHigh;
         double tp = m_symbol.Bid() - (highestHigh - m_symbol.Bid()) * 2;
         m_trade.Sell(InitialLot, _Symbol, m_symbol.Bid(), sl, tp, "Breakout_Short");
        }
     }
     
   // --- DYNAMIC POSITION MANAGEMENT ---
   ManageFloatingPositions();
  }

//+------------------------------------------------------------------+
//| Helper Functions                                                 |
//+------------------------------------------------------------------+
void ManageFloatingPositions()
  {
   for(int i=PositionsTotal()-1; i>=0; i--)
     {
      if(m_position.SelectByIndex(i))
        {
         // Breakeven logic
         if(m_position.PositionType() == POSITION_TYPE_BUY)
           {
            if(m_symbol.Bid() > m_position.PriceOpen() + 200 * _Point)
              {
               m_trade.PositionModify(m_position.Ticket(), m_position.PriceOpen(), m_position.TakeProfit());
              }
           }
         // Advanced HFT-style trailing stop simulation
        }
     }
  }

void OnDeinit(const int reason)
  {
   IndicatorRelease(ATRHandle);
   Print("Quantum Engine: SHUTTING DOWN.");
  }
` }
        };

        const apps = [
            { name: "Terminal", type: "terminal", icon: "fa-terminal", color: "#2ea043" },
            { name: "CustomLLM", type: "neuralchat", icon: "fa-microchip", color: "#a371f7" },
            { name: "Browser", type: "browser", icon: "fa-globe", color: "#58a6ff" },
            { name: "My Files", type: "explorer", icon: "fa-folder", color: "#ffbd2e" },
            { name: "VS Code", type: "editor", icon: "fa-code", color: "#007acc" }
        ];

        let highestZ = 100;
        let windows = [];

        window.onload = async () => {
            // Removed initMatrix call
            
            const logContainer = document.getElementById('boot-log');
            const messages = [
                { text: "Initialising StratOS Kernel...", delay: 400 },
                { text: "Loading Cognitive Engine...", delay: 600 },
                { text: "Initializing AI Systems...", delay: 800 },
                { text: "Mounting Projects...", delay: 600 },
                { text: "Verifying Integrity... OK", delay: 500, color: "#0aff60" },
                { text: "SYSTEM READY", delay: 600, color: "#00f3ff", bold: true }
            ];

            for (const msg of messages) {
                await new Promise(r => setTimeout(r, msg.delay));
                const line = document.createElement('div');
                line.className = 'log-line';
                line.style.color = msg.color || "#8b949e";
                if(msg.bold) line.style.fontWeight = 'bold';
                line.innerText = `> ${msg.text}`;
                logContainer.appendChild(line);
            }

            setTimeout(() => {
                const scr = document.getElementById('boot-screen');
                scr.style.transition = 'opacity 0.8s';
                scr.style.opacity = '0';
                setTimeout(() => scr.style.display = 'none', 800);
                initDesktop();
            }, 800);
        };

        // --- REMOVED MATRIX FUNCTIONS ---

        function initDesktop() {
            const desk = document.getElementById('desktop');
            apps.forEach(app => {
                const el = document.createElement('div');
                el.className = 'desktop-icon';
                el.innerHTML = `<i class="fa-solid ${app.icon}" style="color: ${app.color}"></i><span>${app.name}</span>`;
                el.ondblclick = () => createWindow(app.name, app.type);
                desk.appendChild(el);
            });
            setInterval(updateClock, 1000);
            updateClock();
        }

        function updateClock() {
            const now = new Date();
            document.getElementById('clock-time').innerText = now.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
            document.getElementById('clock-date').innerText = now.toLocaleDateString([], {month:'short', day:'numeric'});
        }

        function toggleStartMenu() {
            const menu = document.getElementById('start-menu');
            menu.style.display = (menu.style.display === 'flex') ? 'none' : 'flex';
        }

        function createWindow(title, type, key = null) {
            highestZ++;
            const id = 'win-' + Date.now();
            const win = document.createElement('div');
            win.className = 'window';
            win.id = id;
            win.style.zIndex = highestZ;
            win.style.left = (100 + windows.length * 30) + 'px';
            win.style.top = (100 + windows.length * 30) + 'px';
            win.style.width = type === 'browser' ? '80%' : '600px';
            win.style.height = type === 'browser' ? '80%' : '450px';

            win.innerHTML = `
                <div class="window-header" onmousedown="startDrag(event, '${id}')">
                    <div class="window-title">${title}</div>
                    <div class="window-controls">
                        <div class="control-btn min-btn" onclick="document.getElementById('${id}').classList.add('minimized')"></div>
                        <div class="control-btn max-btn" onclick="document.getElementById('${id}').classList.toggle('maximized')"></div>
                        <div class="control-btn close-btn" onclick="closeWindow('${id}')"></div>
                    </div>
                </div>
                <div class="window-content" id="content-${id}"></div>
            `;
            document.body.appendChild(win);
            windows.push({ id, title, type });
            renderApp(id, type, key);
            updateTaskbar();
        }

        function closeWindow(id) {
            document.getElementById(id).remove();
            windows = windows.filter(w => w.id !== id);
            updateTaskbar();
        }

        function startDrag(e, id) {
            const win = document.getElementById(id);
            focusWindow(id);
            if (e.target.closest('.window-controls')) return;
            let shiftX = e.clientX - win.getBoundingClientRect().left;
            let shiftY = e.clientY - win.getBoundingClientRect().top;
            function onMove(me) { win.style.left = me.pageX - shiftX + 'px'; win.style.top = me.pageY - shiftY + 'px'; }
            document.addEventListener('mousemove', onMove);
            document.onmouseup = () => { document.removeEventListener('mousemove', onMove); };
        }

        function focusWindow(id) {
            highestZ++;
            document.getElementById(id).style.zIndex = highestZ;
            updateTaskbar();
        }

        function updateTaskbar() {
            const list = document.getElementById('task-list');
            list.innerHTML = '';
            windows.forEach(w => {
                const item = document.createElement('div');
                item.className = 'task-item';
                item.innerHTML = `<i class="fa-solid fa-window-maximize"></i>`;
                item.onclick = () => focusWindow(w.id);
                list.appendChild(item);
            });
        }

        function renderApp(id, type, key) {
            const container = document.getElementById(`content-${id}`);
            if (type === 'terminal') {
                container.innerHTML = `<div class="terminal-app"><div id="term-out-${id}">StratOS v4.6 Terminal</div><div class="term-input-line"><span class="prompt-user">rahul@root:~$</span>&nbsp;<input class="term-input" onkeydown="handleTerm(event, this, '${id}')"></div></div>`;
            } else if (type === 'browser') {
                container.innerHTML = `<div class="browser-app"><div class="browser-bar"><div class="browser-nav" onclick="navBrowser('${id}', 'home')"><i class="fa-solid fa-house"></i></div><div class="browser-nav" onclick="navBrowser('${id}', 'back')"><i class="fa-solid fa-arrow-left"></i></div><div class="url-bar"><span id="url-${id}">Portfolio Hub</span></div></div><div class="browser-content" id="frame-${id}"></div></div>`;
                navBrowser(id, 'home');
            } else if (type === 'neuralchat') {
                container.innerHTML = `<div class="chat-app"><div class="chat-messages" id="chat-out-${id}"></div><div class="chat-input-area"><input class="chat-input" id="chat-in-${id}" onkeydown="if(event.key==='Enter') handleChat('${id}')"><button class="chat-btn" onclick="handleChat('${id}')">Send</button></div></div>`;
            } else if (type === 'editor') {
                const file = key || 'forex_algo.py';
                container.innerHTML = `
                    <div class="vscode-layout" id="editor-layout-${id}">
                        <div class="vscode-sidebar">
                            <div style="padding:10px; font-weight:bold; font-size:11px; opacity:0.6;">EXPLORER</div>
                            <div id="file-list-${id}">
                                ${Object.keys(fileSystem).map(f => `<div class="vscode-file ${f === file ? 'active' : ''}" onclick="switchFile('${id}', '${f}')">${f}</div>`).join('')}
                            </div>
                        </div>
                        <div class="vscode-main">
                            <div class="vscode-editor-area">
                                <div class="vscode-gutter" id="gt-${id}"></div>
                                <div class="vscode-code" id="code-${id}" contenteditable="true" spellcheck="false" oninput="updateGutter('${id}')"></div>
                            </div>
                        </div>
                    </div>`;
                switchFile(id, file);
            } else if (type === 'explorer') {
                container.innerHTML = `<div style="padding:20px">${Object.keys(fileSystem).map(f => `<div style="cursor:pointer; margin-bottom:10px" onclick="createWindow('${f}', 'editor', '${f}')"><i class="fa-solid fa-file"></i> ${f}</div>`).join('')}</div>`;
            }
        }

        function switchFile(id, fileName) {
            const codeArea = document.getElementById(`code-${id}`);
            const fileList = document.getElementById(`file-list-${id}`);
            if (!codeArea || !fileSystem[fileName]) return;

            // Update content
            codeArea.innerText = fileSystem[fileName].content;
            
            // Update sidebar UI
            if (fileList) {
                fileList.querySelectorAll('.vscode-file').forEach(el => {
                    el.classList.toggle('active', el.innerText.trim() === fileName);
                });
            }

            updateGutter(id);
        }

        function updateGutter(id) {
            const codeArea = document.getElementById(`code-${id}`);
            const gutter = document.getElementById(`gt-${id}`);
            if (!codeArea || !gutter) return;
            
            const lines = codeArea.innerText.split('\n').length;
            let lineNums = '';
            for(let i=1; i<=Math.max(lines, 1); i++) {
                lineNums += i + '<br>';
            }
            gutter.innerHTML = lineNums;
        }

        function navBrowser(id, url) {
            const frame = document.getElementById(`frame-${id}`);
            const urlSpan = document.getElementById(`url-${id}`);
            
            if (url === 'home') {
                frame.innerHTML = `
                    <div class="browser-home">
                        <div style="text-align:center">
                            <i class="fa-solid fa-earth-americas" style="font-size:60px; color:#58a6ff; margin-bottom:20px;"></i>
                            <div class="browser-title" style="font-size:24px; font-weight:bold;">Intelligence Hub</div>
                        </div>
                        <div class="dial-grid">
                            <div class="dial-item" onclick="navBrowser('${id}', 'tools-hub')"><div class="dial-icon">üõ†Ô∏è</div><div class="dial-label">Tools</div></div>
                            <div class="dial-item" onclick="loadChess('${id}')"><div class="dial-icon" style="color:#2ecc71"><i class="fa-solid fa-chess-knight"></i></div><div class="dial-label">Chess Stats</div></div>
                            <div class="dial-item" onclick="loadGithub('${id}')"><div class="dial-icon" style="color:#fff"><i class="fa-brands fa-github"></i></div><div class="dial-label">GitHub</div></div>
                            <div class="dial-item" onclick="loadDiscord('${id}')"><div class="dial-icon" style="color:#5865F2"><i class="fa-brands fa-discord"></i></div><div class="dial-label">Discord</div></div>
                        </div>
                    </div>`;
                urlSpan.innerText = "New Tab";
            }¬†
            else if (url === 'back') {
                const current = urlSpan.innerText;
                if (current.includes('vyapari.space')) {
                    navBrowser(id, 'tools-hub');
                } else if (current === 'Tools Hub') {
                    navBrowser(id, 'home');
                } else {
                    navBrowser(id, 'home');
                }
            }
            else if (url === 'tools-hub') {
                frame.innerHTML = `
                    <div class="tools-hub-container">
                        <div class="tools-header">Select a Toolset</div>
                        <div class="tool-cards">
                            <div class="tool-card" onclick="navBrowser('${id}', 'https://www.vyapari.space/aitools/')">
                                <div class="tool-bg"></div>
                                <div class="tool-icon"><i class="fa-solid fa-wand-magic-sparkles"></i></div>
                                <div class="tool-name">AI Suite</div>
                                <div class="tool-desc">Access advanced AI utilities</div>
                            </div>
                            <div class="tool-card" onclick="navBrowser('${id}', 'https://www.vyapari.space/tools/')">
                                <div class="tool-bg" style="background: linear-gradient(45deg, #ff7b72, #ffbd2e);"></div>
                                <div class="tool-icon"><i class="fa-solid fa-toolbox"></i></div>
                                <div class="tool-name">General Utilities</div>
                                <div class="tool-desc">Everyday developer tools</div>
                            </div>
                            <div class="tool-card" onclick="navBrowser('${id}', 'https://www.vyapari.space/coder/')">
                                <div class="tool-bg" style="background: linear-gradient(45deg, #2ea043, #58a6ff);"></div>
                                <div class="tool-icon"><i class="fa-solid fa-laptop-code"></i></div>
                                <div class="tool-name">Coder Space</div>
                                <div class="tool-desc">IDE & Coding Tools</div>
                            </div>
                        </div>
                    </div>
                `;
                urlSpan.innerText = "Tools Hub";
            }
            else {
                frame.innerHTML = `<iframe src="${url}" allow="camera; microphone; fullscreen; display-capture; geolocation" style="width:100%; height:100%; border:none; display:block;"></iframe>`;
                urlSpan.innerText = url;
            }
        }

        async function loadChess(id) {
            const frame = document.getElementById(`frame-${id}`);
            document.getElementById(`url-${id}`).innerText = "chess.com/member/MysteriousThoughts";
            frame.innerHTML = `<div style="padding:20px; color:white;">Loading Chess Data...</div>`;
            
            try {
                const profileRes = await fetch('https://api.chess.com/pub/player/MysteriousThoughts');
                const profile = await profileRes.json();
                const statsRes = await fetch('https://api.chess.com/pub/player/MysteriousThoughts/stats');
                const stats = await statsRes.json();

                const avatar = profile.avatar || 'https://images.chesscomfiles.com/uploads/v1/user/null.png';
                const rapidElo = stats.chess_rapid?.last?.rating || 'N/A';
                const rapidPeak = stats.chess_rapid?.best?.rating || 'N/A';
                const blitzElo = stats.chess_blitz?.last?.rating || 'N/A';
                const blitzPeak = stats.chess_blitz?.best?.rating || 'N/A';
                
                frame.innerHTML = `
                    <div style="width:100%; height:100%; background:#0d1117; display:flex; justify-content:center; align-items:center;">
                        <div class="chess-card">
                            <div style="display:flex; align-items:center; gap:15px; width:100%;">
                                <img src="${avatar}" class="chess-avatar">
                                <div>
                                    <div style="font-size:20px; font-weight:bold; color:#fff">${profile.username}</div>
                                    <div style="color:#8b949e; font-size:12px;">Grandmaster Strategy</div>
                                </div>
                            </div>
                            <div class="chess-stats-grid">
                                <div class="stat-box">
                                    <div class="stat-label">Rapid</div>
                                    <div class="stat-val" style="color:#ffce47">${rapidElo}</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-label">Peak</div>
                                    <div class="stat-val">${rapidPeak}</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-label">Blitz</div>
                                    <div class="stat-val" style="color:#ff7b72">${blitzElo}</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-label">Peak</div>
                                    <div class="stat-val">${blitzPeak}</div>
                                </div>
                            </div>
                            <div class="chess-quote">"The best move is the one that restricts your opponent."</div>
                        </div>
                    </div>`;
            } catch(e) {
                frame.innerHTML = `<div style="padding:20px; color:#ff7b72">Failed to load Chess stats.</div>`;
            }
        }

        async function loadGithub(id) {
            const frame = document.getElementById(`frame-${id}`);
            document.getElementById(`url-${id}`).innerText = "github.com/SolvyrEryx";
            
            // Check cache
            const cacheKey = 'neural_gh_cache_solvyr';
            const cached = localStorage.getItem(cacheKey);
            let data = null;

            if (cached) {
                const parsed = JSON.parse(cached);
                if (Date.now() - parsed.timestamp < 3600000) data = parsed.data;
            }

            if (!data) {
                frame.innerHTML = `<div style="padding:20px; color:white;">Loading GitHub Data...</div>`;
                try {
                    const userRes = await fetch('https://api.github.com/users/SolvyrEryx');
                    const user = await userRes.json();
                    const reposRes = await fetch('https://api.github.com/users/SolvyrEryx/repos?sort=updated&per_page=100');
                    const repos = await reposRes.json();
                    data = { user, repos };
                    localStorage.setItem(cacheKey, JSON.stringify({ timestamp: Date.now(), data }));
                } catch (e) {
                    frame.innerHTML = `<div style="padding:20px; color:#ff7b72;">Failed to load GitHub data.</div>`;
                    return;
                }
            }

            const { user, repos } = data;
            const repoHtml = Array.isArray(repos) ? repos.map(r => {
                const langColor = { Python:'#3572A5', JavaScript:'#f1e05a', HTML:'#e34c26', CSS:'#563d7c', TypeScript:'#2b7489' }[r.language] || '#ccc';
                return `
                <div class="card">
                    <div class="card-left">
                        <div class="card-title">
                            <i class="fa-solid fa-book-bookmark" style="color:#8b949e;"></i> 
                            <span style="margin-left:5px">${r.name}</span>
                        </div>
                        <div class="card-desc">${r.description || 'No description provided.'}</div>
                        <div class="card-meta">
                            <span><span class="lang-dot" style="background:${langColor}"></span>${r.language || 'Text'}</span>
                            <span><i class="fa-regular fa-star"></i> ${r.stargazers_count}</span>
                            <span><i class="fa-solid fa-code-fork"></i> ${r.forks_count}</span>
                        </div>
                    </div>
                    <div class="card-actions">
                        <a href="${r.html_url}" target="_blank" class="repo-btn"><i class="fa-brands fa-github"></i> GitHub</a>
                    </div>
                </div>`;
            }).join('') : '<div style="padding:20px">No repositories found.</div>';

            frame.innerHTML = `
                <div class="social-feed">
                    <div class="github-layout">
                        <div class="github-sidebar">
                            <img src="${user.avatar_url}" class="profile-img">
                            <div class="profile-name">${user.name || user.login}</div>
                            <div class="profile-login">${user.login}</div>
                            <div class="profile-bio" style="color:#aaa; margin-bottom:15px; font-size:13px;">${user.bio || 'System Architect'}</div>
                            <div class="profile-stats" style="color:#ccc; font-size:13px;"><i class="fa-solid fa-users"></i> <b>${user.followers}</b> followers ¬∑ <b>${user.following}</b> following</div>
                        </div>
                        <div class="github-main">
                            <div class="repo-grid">${repoHtml}</div>
                        </div>
                    </div>
                </div>`;
        }

        async function loadDiscord(id) {
            const frame = document.getElementById(`frame-${id}`);
            document.getElementById(`url-${id}`).innerText = "discord.com/users/" + DISCORD_ID;
            frame.innerHTML = `<div style="padding:20px; color:white;">Connecting to Lanyard...</div>`;

            try {
                const res = await fetch(`https://api.lanyard.rest/v1/users/${DISCORD_ID}`);
                const json = await res.json();
                const d = json.data;
                const user = d.discord_user;
                const avatar = `https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png?size=256`;
                const bannerStyle = d.discord_user.banner ? `background-image: url('https://cdn.discordapp.com/banners/${user.id}/${user.banner}.png?size=512');` : `background-color: ${d.kv?.accent_color || '#18191c'}`;
                const statusColor = { online:'#23a559', idle:'#f0b232', dnd:'#f23f43', offline:'#80848e' }[d.discord_status];

                frame.innerHTML = `
                    <div class="discord-container">
                        <div class="discord-modal">
                            <div class="discord-banner" style="${bannerStyle}"></div>
                            <div class="discord-avatar-wrapper">
                                <img src="${avatar}" class="discord-avatar">
                                <div class="discord-status-dot" style="background-color:${statusColor}"></div>
                            </div>
                            <div class="discord-badges">
                                <div class="discord-badge" title="Developer"><i class="fa-solid fa-code" style="color:#fff"></i></div>
                            </div>
                            <div class="discord-body">
                                <div class="discord-username">${user.global_name || user.username}</div>
                                <div class="discord-handle">${user.username}</div>
                                <div class="discord-section-title">Bio</div>
                                <div class="discord-bio">Engineer defined by strategy. Calculated risk.</div>
                                ${d.activities.length > 0 ? `
                                <div class="discord-section-title">Activity</div>
                                <div class="discord-activity-card">
                                    <div>
                                        <div style="font-weight:bold; font-size:14px; color:#fff">${d.activities[0].name}</div>
                                        <div style="font-size:13px; color:#b9bbbe">${d.activities[0].state || ''}</div>
                                    </div>
                                </div>` : ''}
                            </div>
                        </div>
                    </div>`;
            } catch (e) {
                frame.innerHTML = `<div style="padding:20px; color:#ff7b72;">Failed to fetch Discord status.</div>`;
            }
        }

        async function handleChat(id) {
            const input = document.getElementById(`chat-in-${id}`);
            const out = document.getElementById(`chat-out-${id}`);
            const text = input.value.trim();
            if(!text) return;
            
            // User Message
            out.innerHTML += `<div class="chat-bubble user">${text}</div>`;
            input.value = '';
            out.scrollTop = out.scrollHeight;

            // Image Generation Logic (Pollinations AI)
            const lowerText = text.toLowerCase();
            if (lowerText.startsWith('/image') || lowerText.startsWith('generate image') || lowerText.startsWith('draw')) {
                const prompt = text.replace(/^\/image|generate image|draw/i, '').trim();
                if (prompt.length > 0) {
                    out.innerHTML += `<div class="chat-bubble bot">Generating visual representation of: "${prompt}"...</div>`;
                    out.scrollTop = out.scrollHeight;
                    
                    const imgUrl = `https://image.pollinations.ai/prompt/${encodeURIComponent(prompt)}`;
                    const imgTag = `<img src="${imgUrl}" onload="this.parentElement.scrollIntoView()" onerror="this.parentElement.innerText='Image generation failed.'" style="max-width:100%; border-radius:8px; margin-top:5px;">`;
                    
                    // Simulate a small delay for "thinking"
                    setTimeout(() => {
                        out.innerHTML += `<div class="chat-bubble bot">${imgTag}</div>`;
                        out.scrollTop = out.scrollHeight;
                    }, 1000);
                    return;
                }
            }

            // Text Generation Logic (Mistral)
            try {
                const res = await fetch('https://api.mistral.ai/v1/chat/completions', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${MISTRAL_KEY}` },
                    body: JSON.stringify({ model: "mistral-medium", messages: [{role: "user", content: text}] })
                });
                const data = await res.json();
                const reply = data.choices && data.choices.length > 0 ? data.choices[0].message.content : "No response from neural core.";
                out.innerHTML += `<div class="chat-bubble bot">${reply}</div>`;
            } catch(e) { 
                out.innerHTML += `<div class="chat-bubble bot">Neural link error: ${e.message}</div>`; 
            }
            out.scrollTop = out.scrollHeight;
        }

        function handleTerm(e, input, id) {
            if(e.key === 'Enter') {
                const out = document.getElementById(`term-out-${id}`);
                out.innerHTML += `<div>rahul@root:~$ ${input.value}</div>`;
                if(input.value === 'whoami') out.innerHTML += `<div>Rahul J | Strategic Architect</div>`;
                input.value = '';
            }
        }
    </script>
</body>
</html>
